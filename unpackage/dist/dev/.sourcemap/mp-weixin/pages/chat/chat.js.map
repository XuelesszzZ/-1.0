{"version":3,"sources":["uni-app:///main.js",null,"webpack:///D:/‰ªøÂæÆ‰ø°wechat/pages/chat/chat.vue?1e4c","webpack:///D:/‰ªøÂæÆ‰ø°wechat/pages/chat/chat.vue?d2ed","webpack:///D:/‰ªøÂæÆ‰ø°wechat/pages/chat/chat.vue?6d72","uni-app:///pages/chat/chat.vue","webpack:///D:/‰ªøÂæÆ‰ø°wechat/pages/chat/chat.vue?4ac6","webpack:///D:/‰ªøÂæÆ‰ø°wechat/pages/chat/chat.vue?d185"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","showAutoComplete","showQuickReply","selectedQuickReplyItem","roomType","info","kjList","isHistoryLoading","scrollAnimation","scrollTop","scrollToView","windowHeight","emojData","swiperIndex","csHeiht","selectedEmoji","msgImgList","historyList","fromUserInfo","formData","content","limit","index","showOrderPopup","showcustomer","ws","hosId","loading","hosType","status","messageList","popTile","jkId","infoLeft","safeAreaInsetBottom","uni","icon","title","uploadType","components","OrderPopup","customer","QuickReply","AutoComplete","watch","val","mounted","methods","convertTimestampsToDates","item","key","updateFooterHeight","query","px2rpx","handleInput","clearTimeout","autoComplete","client_id","keywords","resolve","handleSelectSuggestion","handleCloseAutoComplete","dataContent","console","getList","scrollBool","handleQuickReplyClick","del","arr","loadHistory","setTimeout","setPicSize","handleSelectOrder","handleSelect","closeBox","closeKf","init","maxReconnect","reconnectDelay","heartbeatInterval","res","i","gethistoryList","switchChatType","emogiFun","switchFun","tuchEmoj","swiperChange","sendMsg","token","type","shop_id","user_id","content_type","room_type","sedData","touchstart","linkToBusinessCard","startVoice","format","beginVoice","moveVoice","endVoice","cancelVoice","handleRecorder","tempFilePath","duration","contentDuration","contentType","handleAudio","playAudio","stopAudio","closeAnmition","clickGrid","chooseImage","count","mediaType","sourceType","maxDuration","success","uploadFiles","uploadImageInH5","fetch","response","blob","file","result","uploadImageInMiniProgram","url","filePath","name","header","path","reject","fail","Promise","then","catch","viewImg","urls","onPageScroll","onNavigationBarButtonTap","onBackPress","onUnload","onLoad","params","clearInterval","onReady"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,aAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA6H;AAC7H;AACwD;AACL;AACsC;;;AAGzF;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,+FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,2OAEN;AACP,KAAK;AACL;AACA,aAAa,qOAEN;AACP,KAAK;AACL;AACA,aAAa,2OAEN;AACP,KAAK;AACL;AACA,aAAa,+NAEN;AACP,KAAK;AACL;AACA,aAAa,6PAEN;AACP,KAAK;AACL;AACA,aAAa,+NAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,mBAAO,CAAC,6BAAoB;AAClE,yCAAyC,mBAAO,CAAC,gCAAuB;AACxE,WAAW,mBAAO,CAAC,4BAAmB;AACtC,WAAW,mBAAO,CAAC,2BAAkB;AACrC;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC7EA;AAAA;AAAA;AAAA;AAA8lB,CAAgB,wnBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;ACuPlnB;AAGA;AAKA;AAEA;AAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA,eAEA;EACAC;IAAA;IACA;MAGAC;MACAC;MACAC;MACAC;MACAC;MAEAC,UACA;MAEAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MACA;MACA,CACA,4DACA,4DACA,0DACA,WACA;MAEA;MACA,CACA,4DACA,4DACA,6DACA,WACA;MAEA;MACA,CACA,4DACA,4DACA,4DACA,WACA;MAEA;MACA,CACA,4DACA,4DACA,4DACA,WACA;MAEA;MACA,CACA,4DACA,4DACA,2DACA,WACA,CACA;MACAC;MAAA;MACAC;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;QACAC;QACAC;QACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;MACAC;MACAC,eACA;MACAC;MACAC;MACAC;MACAC;IAAA,kDACA,wDACA,gEACA,wDACA,4DACA,4DACA,4DACA,uDACAC,wEACAA,iFACA,2DACA,6DACA,wDACA,mDACA,qDACA,yDACA,8DACA,wDACA,yDACA,sEACA,4DACA,oDACA;MACAC;MACAC;MACAC;IACA,GACA;MACAF;MACAC;MACAC;IACA,GACA;MACAF;MACAC;IAEA,GACA;MACAD;MACAC;IACA,GACA;MACAD;MACAC;IACA,EACA,mDACA,gEACA;EAGA;EACAE;IACAC;IACAC;IACAC;IACAC;EACA;EACAC;IACA;IACA1C;MACA;QACA;MACA;IACA;IACA;MACA;IACA;EAAA,mFACA2C;IAEA;MACA;IAEA;EAEA,wEACAA;IACA;MACA;IAEA;EACA,4EACAA;IACA;MACA;IAEA;EACA,WAEA;EAEAC,6BAGA;EACAC;IACA;IACAC;MAAA;MAGA;QAEA,uCACAC,6CACAC;MAEA;IACA;IAEAC;MAAA;MACA;MACA;QACA;QACAC;UACA;YACA;YACA;YACA;cACA;YACA;cACA;YACA;UAGA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;IACA;IACAC;MAAA;MAKA;QACAC;MACA;MACA;QAEA;UACA;QAEA;;QAIA;MACA;IAGA;IACA;IACAC;MAAA;MACA;QACA;UACAC;UACAC;QACA;UACA;YAEA;cACA;cACA;YACA;cACA;YACA;UAGA;UACAC;QACA;UACAA;UACA;QACA;MACA;IACA;IACAC;MAAA;MAGA;MACA;MACA;QACA;QACA;MAEA;IAEA;IACAC;MACA;IACA;IACA;IACAC;MACAC;MACA;IAEA;IACA;IACAC;MAAA;MACAD;MAEA;QACA;UACAN;QACA;UACA;YACA;YACA;YACAM;UAEA;UACAJ;QACA;UACAA;UACA;QACA;MACA;IACA;IACAM;MACA;MACA;MACA;MACA9B;IAEA;IACA+B;MACA;MACA;MACA;MACA;MACA;QACA;UACA;UAEA;QACA;UACA;UACA;UACA;QACA;MACA;QAEA;QAEA;MACA;IACA;IACAC;MAEA;MACAC;MACA;MACAL;IACA;IACA;IACAM;MAAA;MAEA;QACA;MACA;MACA;MACA;MACA;MACA;MACAC;QACA;;QAEA;QACA;UAEA;UACA;QACA;QACA;QACA;UACA;UACA;YACA;UACA;QAEA;;QACA;MAEA;IACA;IAEA;IACAC;MACA;MACA;MACA;MACA;QACA;QACAnD;QACAA;MACA;MACA;IACA;IACA;IACAoD;MAEA;;MAEA;IACA;IACA;IACAC,2CAEA;IACA;IACAC;MAEA;IACA;IACAC;MAEA;IACA;IACAC;MAAA;MACA;MACA;QACAC;QAAA;QACAC;QAAA;QACAC;MACA;;MAEA;MACA;QAEA;MACA;MACA;MACA;MACA;QAAA;MAAA;MACA;QAAA;MAAA;MACA;QACAhB;QAEA;UAEA;UACA;QAEA;QACA;UACAiB;UACA;UACA;QACA;QACA;UAEA;UACA;UAEA,uBACA;YACAC;YACAA;YACA;cACAA;YACA;cACAA;YACA;UAEA,EAGA;QAEA;MAIA;IACA;IAEA;IACAC;MAAA;MAEA;QACA;UACAzB;QACA;UAEA;YACA;UACA;UACAE;QACA;UAEAA;UACA;QACA;MACA;IAEA;IAOA;IACAwB;MAEA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;MACA;MACAjD;MACA;MACA;IAGA;IACA;IACAkD;MACA;MACA;MACA;MACA;MACA;MACAlD;IAEA;IACAmD;MACA;IAEA;IACAC;MACA;IACA;IAGA;IACAC;MAAA;MAEA;QACAC;QACAC;QACAC;QACAC;QACAC;QACAzE;QACA0E;MAEA;MACA;QACAC;MAEA;QACAA;MACA;MAGA;QACA;UACA;UACAA;UACAA;UACAA;QAEA;UACA;UACAA;UACAA;UACAA;QAGA;UACA;UACAA;UACAA;UACAA;UACAA;UACAA;QAEA;UACA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;UACAA;QAGA;MACA;QACA;QACA;MACA;MAEA;MAEAA,sBAEAA;MACA;MACA,qBACA;QACAd;MACA,EAEA;MAEA;QACA;QACA;QAGA;QAOA;UACA;QACA;QAGA;UACA;QACA;;QAEA;MAIA;IACA;IAGA;IACAe;MACA7D;MACA;MACA;IAEA;IACA;IACA8D;MACA;MACA;MACA;MACA;MACA;MACA;IAAA,CACA;IACA;IACAC;MACA;QACA;QACA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;QACAC;MACA;IACA;IACA;IACAC;MAAA;MACA;QACA;QACA;MACA;MACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;QACA;QACA;MACA;QACA;QACA;MACA;QACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA;IACA;IACA;IACAC,+CAGA;MAAA;MAAA,IAFAC;QACAC;MAEA;MAEA;MACA;QACA;QACApC;UACA;QACA;QACA;MACA;MACAqC;MAeA;MACA;QACAC;QACAxF;QACAuF;MACA;MACA;IACA;IACA;IACAE;MACA;MACA;IACA;IACA;IACAC;MACA;MACA;MACA;MACA7D;IACA;IACA;IACA8D;MACA9D;MACA;MACA;IACA;IACA;IACA+D;MACA;MACA;QAAA;MAAA;MACA/D;IACA;IACA;IACAgE;MACA;QACA;MACA;QACA;MACA;QAEA;QACA;QACA;MACA;QAEA;QACA;QACA;MACA;QACA;UACAxB;UACAC;UACAI;QACA;QACA;QACA;QACA;MACA;IACA;IACA;IACAoB;MAAA;MACA/E;QACAgF;QACAC;QAAA;QACAC;QACAC;QACAC;UACA;UAEA;QACA;MACA;IAEA;IACA;IACAC;MAEA;;MAMA;IAEA;IACA;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAGAC;cAAA;gBAAAC;gBAAA;gBAAA,OACAA;cAAA;gBAAAC;gBACAC;kBACAnC;gBACA,IAEA;gBACAvE;gBACAA;gBACAA;;gBAEA;gBAAA;gBAAA,OACA;cAAA;gBAAA2G;gBACA/D;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA;IACAgE;MAAA;MAEA;QAEA;UACA5F;YACA6F;YACAC;YACAC;YAAA;YACAC;cACA;YAEA;YACAhH;cACAsC;YACA;YACA8D;cACA;gBACA;kBACA;kBAEA;oBACAX;oBACAxF;oBACAgH;kBACA;gBAEA;kBACAC;gBACA;cACA;gBACAA;cACA;YACA;YACAC;cACAD;YACA;UACA;QACA;MACA;;MAEA;MACAE,yBACAC;QACA;QACAzE;MAIA,GACA0E;QACA1E;QACA5B;UACAE;UACAD;QACA;MACA;IAEA;IACA;IACAsG;MACAvG;QACAwG;MAIA;IACA;EACA;EACAC;;IAEA;IACA;EAAA,CACA;EAGAC,mEAEA;IAAA,IADAvH;IAEA;MACA;IAAA,CACA;MAEA;MACA;QACAoE;QACAsC;MACA;IACA;EACA;EACA;EACAc;IACA;IACA;IACA;MACApD;MACAsC;IACA;IACA;EACA;EACAe;IACA;MACAjD;MACAJ;MACAD;IACA;IACA;IAEA;MACA;IACA;EACA;EAEAuD;IAAA;IAGA;IACA5F;MACA;QAEA;QACA;MACA;IACA;IAGAjB;MACAoF;QACA;QACA;QACAxD;;QAEA;QACA;MAEA;IACA;IAIA;IACA5B;MACAE;IACA;IACA;IACA;MAEAuD;MACAD;MACAG;MACAJ;MACAD;IACA;IACA;IACA;MACAwD;MACA;IACA;MACAA;MACA;IACA;IAEA;;IAEA;IACA;MACA;MACA;MACA;MACA;IACA;;IAIA;IACA;MAEA;IACA;IACA;IACA;MACAC;MACA;IACA;;IAEA;IACA;MACA;IACA;;IAEA;IACA;MACA;IACA;EACA;EACAC;IAAA;IAEA;;IAMAhH;MACAE;IACA;IACA;IACAF;MACAoF;QACA;MACA;IACA;IAEApF;MACA;QAEA;MAEA;QACA;MACA;IACA;EAEA;AACA;AAAA,2B;;;;;;;;;;;;;ACzyCA;AAAA;AAAA;AAAA;AAAiqC,CAAgB,uoCAAG,EAAC,C;;;;;;;;;;;ACArrC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/chat/chat.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./chat.vue?vue&type=template&id=bf16e7f4&scoped=true&\"\nvar renderjs\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"bf16e7f4\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/chat/chat.vue\"\nexport default component.exports","export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=template&id=bf16e7f4&scoped=true&\"","var components\ntry {\n  components = {\n    uAvatar: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-avatar/u-avatar\" */ \"uview-ui/components/u-avatar/u-avatar.vue\"\n      )\n    },\n    uImage: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-image/u-image\" */ \"uview-ui/components/u-image/u-image.vue\"\n      )\n    },\n    uButton: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-button/u-button\" */ \"uview-ui/components/u-button/u-button.vue\"\n      )\n    },\n    uGrid: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-grid/u-grid\" */ \"uview-ui/components/u-grid/u-grid.vue\"\n      )\n    },\n    uGridItem: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-grid-item/u-grid-item\" */ \"uview-ui/components/u-grid-item/u-grid-item.vue\"\n      )\n    },\n    uIcon: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/uview-ui/components/u-icon/u-icon\" */ \"uview-ui/components/u-icon/u-icon.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. ÊéíÊü•ÁªÑ‰ª∂ÂêçÁß∞ÊãºÂÜôÊòØÂê¶Ê≠£Á°Æ\")\n    console.error(\n      \"2. ÊéíÊü•ÁªÑ‰ª∂ÊòØÂê¶Á¨¶Âêà easycom ËßÑËåÉÔºåÊñáÊ°£Ôºöhttps://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. Ëã•ÁªÑ‰ª∂‰∏çÁ¨¶Âêà easycom ËßÑËåÉÔºåÈúÄÊâãÂä®ÂºïÂÖ•ÔºåÂπ∂Âú® components ‰∏≠Ê≥®ÂÜåËØ•ÁªÑ‰ª∂\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.kjList.length\n  var m0 = _vm.chatType === \"voice\" ? require(\"@/static/voice.png\") : null\n  var m1 = _vm.chatType === \"keyboard\" ? require(\"@/static/keyboard.png\") : null\n  var m2 = require(\"@/static/face.png\")\n  var m3 = require(\"@/static/add.png\")\n  var g1 = _vm.$u.trim(this.formData.content)\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        m0: m0,\n        m1: m1,\n        m2: m2,\n        m3: m3,\n        g1: g1,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"content\">\r\n        <view class=\"content-box\" @touchstart=\"touchstart\" id=\"content-box\"\r\n            :class=\"{'emoji-active':showFunBtn, 'emoji-active': emogiBox, 'showQuickReply-active': showQuickReply}\">\r\n            <!-- ËÉåÊôØÂõæ- ÂÆö‰ΩçÊñπÂºè -->\r\n            <!-- \t<image class=\"content-box-bg\" :src=\"_user_info.chatBgImg\" :style=\"{ height: imgHeight }\"></image> -->\r\n            <view class=\"serviceReminder\">\r\n                <u-avatar :src=\"infoData.headimgurl\" size=\"70\"></u-avatar>\r\n                <view class=\"minderText\">\r\n                    {{infoData.title?infoData.title:'Á≥ªÁªüÂÆ¢Êúç'}},ÂâçÊù•ÊúçÂä°~\r\n                </view>\r\n            </view>\r\n            <scroll-view class=\"msg-list\" scroll-y=\"true\" :scroll-with-animation=\"scrollAnimation\"\r\n                :scroll-top=\"scrollTop\" :scroll-into-view=\"scrollToView\" @scrolltoupper=\"loadHistory\"\r\n                ref=\"scrollContainer\" upper-threshold=\"50\" @click=\"scrollBool\">\r\n                <!-- Âä†ËΩΩÂéÜÂè≤Êï∞ÊçÆwaitingUI -->\r\n                <view class=\"loading\" v-if=\"isHistoryLoading\">\r\n                    <view class=\"spinner\">\r\n                        <view class=\"rect1\"></view>\r\n                        <view class=\"rect2\"></view>\r\n                        <view class=\"rect3\"></view>\r\n                        <view class=\"rect4\"></view>\r\n                        <view class=\"rect5\"></view>\r\n                    </view>\r\n                </view>\r\n                <view class=\"message\" v-for=\"(item, index) in messageList\" :key=\"index\"\r\n                    :id=\"`msg-${item.hasBeenSentId}`\">\r\n                    <view class=\"timeBox\" v-if=\"item.create_time\">\r\n                        {{item.create_time}}\r\n                    </view>\r\n                    <view class=\"message-item \" :class=\"item.is_me ? 'right' : 'left'\">\r\n\r\n                        <!-- contentType = 1 ÊñáÊú¨ -->\r\n                        <view class=\"contentText\" v-if=\"item.content_type == 1\">{{ item.content }}</view>\r\n                        <!-- contentType = 2 ÂõæÁâá -->\r\n                        <view class=\"contentText contentType3\" v-if=\"item.content_type == 2\"\r\n                            @tap=\"viewImg([item.path])\">\r\n                            <image :src=\"item.path\" class=\"img\" mode=\"widthFix\"></image>\r\n                        </view>\r\n                        <!-- contentType = 3 ËßÜÈ¢ë -->\r\n                        <view class=\"contentVideo \" v-if=\"item.content_type == 3\">\r\n                            <video :src=\"item.path\"></video>\r\n\r\n                        </view>\r\n                        <!-- contentType = 4 ÂïÜÂìÅÂç°Áâá -->\r\n                        <view class=\"contentGoods \" v-if=\"item.content_type == 4\">\r\n                            <view class=\"goodsTop\">\r\n                                <view class=\"top_img\">\r\n                                    <u-image :src=\"item.sender_id != undefined?item.content.thumb_url:item.thumb_url\"\r\n                                        width=\"130rpx\" height=\"120rpx\"></u-image>\r\n                                </view>\r\n                                <view class=\"topText\">\r\n                                    <view class=\"text\">\r\n                                        {{item.sender_id != undefined?item.content.title:item.title}}\r\n                                    </view>\r\n                                    <view class=\"price\">\r\n\r\n                                        Ôø•{{item.sender_id != undefined?item.content.price:item.price}}\r\n                                    </view>\r\n\r\n                                </view>\r\n                            </view>\r\n                            <view class=\"goodsFooter\">\r\n                                <u-button size=\"mini\" shape=\"circle\"\r\n                                    :custom-style=\"{background: '#FF4400',color: '#fff'}\">ÂéªË¥≠‰π∞</u-button>\r\n\r\n                            </view>\r\n                        </view>\r\n                        <!-- contentType = 5 ËÆ¢ÂçïÂç°Áâá -->\r\n                        <view class=\"contentOrder \" v-if=\"item.content_type == 5\">\r\n                            <view class=\"title\">\r\n                                ÊàëË¶ÅÂí®ËØ¢ËøôÁ¨îËÆ¢Âçï\r\n                            </view>\r\n                            <view class=\"goodsTop\">\r\n                                <view class=\"top_img\">\r\n                                    <u-image\r\n                                        :src=\"item.sender_id != undefined?item.content.goods.thumb_url:item.thumb_url\"\r\n                                        width=\"130rpx\" height=\"120rpx\"></u-image>\r\n                                </view>\r\n                                <view class=\"topText\">\r\n                                    <view class=\"text\">\r\n                                        <view class=\"shopText\">\r\n                                            {{item.sender_id != undefined?item.content.shop.title:item.shop_title}}\r\n                                        </view>\r\n                                        <view class=\"title\">\r\n                                            {{item.sender_id != undefined?item.content.goods.title:item.title}}\r\n                                        </view>\r\n                                    </view>\r\n                                    <view class=\"price\">\r\n                                        <view class=\"num1\">\r\n                                            Ôø•{{item.sender_id != undefined?item.content.goods.price:item.price}}\r\n                                        </view>\r\n                                        <view class=\"num\">\r\n                                            ÂÖ±{{item.sender_id != undefined?item.content.goods.num:item.num}}‰ª∂ÂïÜÂìÅ\r\n                                        </view>\r\n                                    </view>\r\n\r\n                                </view>\r\n                            </view>\r\n\r\n                            <view class=\"orderNum\">\r\n                                <view class=\"bh\">\r\n                                    ËÆ¢ÂçïÁºñÂè∑:{{item.sender_id != undefined?item.content.order_number:item.order_number}}\r\n                                </view>\r\n                                <view class=\"bh\">\r\n                                    ËÆ¢ÂçïÊó∂Èó¥:{{item.sender_id != undefined?item.content.order_time:item.order_time}}\r\n                                </view>\r\n\r\n\r\n                            </view>\r\n                            <view class=\"goodsFooter\">\r\n                                <u-button size=\"mini\" shape=\"circle\"\r\n                                    :custom-style=\"{background: '#2b85e4',color: '#fff'}\">Êü•ÁúãËÆ¢Âçï</u-button>\r\n\r\n                            </view>\r\n                        </view>\r\n\r\n\r\n\r\n                        <!-- contentType = 2 ËØ≠Èü≥ -->\r\n                        <!-- {{item.hasBeenSentId != undefined?item.content.title:item.title}}-->\r\n                        <!-- \t\t\t\t\t<view class=\"content contentType2\" :class=\"[{ 'content-type-right': item.is_me }]\"\r\n\t\t\t\t\t\tv-if=\"item.content_type == 3\" @tap=\"handleAudio(item)\" hover-class=\"contentType2-hover-class\"\r\n\t\t\t\t\t\t:style=\"{width:`${130+(item.contentDuration*2)}rpx`}\">\r\n\t\t\t\t\t\t<view class=\"voice_icon\" :class=\"[\r\n\t\t\t\t\t\t\t\t{ voice_icon_right: item.is_me },\r\n\t\t\t\t\t\t\t\t{ voice_icon_left: !item.is_me },\r\n\t\t\t\t\t\t\t\t{ voice_icon_right_an: item.anmitionPlay && item.is_me },\r\n\t\t\t\t\t\t\t\t{ voice_icon_left_an: item.anmitionPlay && !item.is_me }\r\n\t\t\t\t\t\t\t]\"></view>\r\n\t\t\t\t\t\t<view class=\"\">{{ item.contentDuration }}''</view>\r\n\t\t\t\t\t</view> -->\r\n\r\n\r\n                    </view>\r\n                </view>\r\n            </scroll-view>\r\n            <view class=\"kjBox\" v-if=\"kjList.length > 0\">\r\n                <view class=\"quick-reply\" v-for=\"(item, index) in kjList\" :key=\"index\"\r\n                    @click=\"handleQuickReplyClick(item,index)\"\r\n                    :class=\"{ 'selected': selectedQuickReplyIndex === index }\">\r\n                    {{item.name}}\r\n\r\n                </view>\r\n            </view>\r\n        </view>\r\n\r\n        <!-- Â∫ïÈÉ®ËÅäÂ§©ËæìÂÖ•Ê°Ü -->\r\n        <view class=\"input-box\" :class=\"{ 'input-box-mpInputMargin': mpInputMargin }\" ref=\"footerRef\"\r\n            @touchmove.stop.prevent>\r\n            <view class=\"input-box-flex\">\r\n                <!-- #ifndef H5 -->\r\n                <image v-if=\"chatType === 'voice'\" class=\"icon_img\" :src=\"require('@/static/voice.png')\"\r\n                    @click=\"switchChatType('keyboard')\"></image>\r\n                <image v-if=\"chatType === 'keyboard'\" class=\"icon_img\" :src=\"require('@/static/keyboard.png')\"\r\n                    @click=\"switchChatType('voice')\"></image>\r\n                <!-- #endif -->\r\n                <view class=\"input-box-flex-grow\">\r\n                    <textarea v-if=\"chatType === 'voice'\" type=\"text\" class=\"content\" id=\"input\"\r\n                        v-model=\"formData.content\" :hold-keyboard=\"true\" :confirm-type=\"'send'\" :confirm-hold=\"true\"\r\n                        auto-height=\"true\" placeholder-style=\"color:#DDDDDD;\" :cursor-spacing=\"10\" @input=\"handleInput\"\r\n                        @confirm=\"sendMsg(null)\" ref=\"input\" :show-confirm-bar='false' confirm-type=\"done\" />\r\n                    <!-- <textarea v-model=\"formData.content\" v-if=\"chatType === 'voice'\" id=\"input\" \r\n                        border=\"true\"  auto-height=\"true\" clearable=\"false\" :cursor-spacing=\"10\"\r\n                        adjust-position=\"true\" @input=\"handleInput\" @confirm=\"sendMsg(null)\"\r\n                        :hold-keyboard=\"true\" :confirm-hold=\"true\" class=\"content\" /> -->\r\n\r\n\r\n                    <view class=\"voice_title\" v-if=\"chatType === 'keyboard'\"\r\n                        :style=\"{ background: recording ? '#c7c6c6' : '#FFFFFF' }\" @touchstart.stop.prevent=\"startVoice\"\r\n                        @touchmove.stop.prevent=\"moveVoice\" @touchend.stop=\"endVoice\" @touchcancel.stop=\"cancelVoice\">\r\n                        {{ voiceTitle }}\r\n                    </view>\r\n                </view>\r\n                <!-- Ë°®ÊÉÖÊåâÈíÆ -->\r\n                <image class=\"emoji icon_btn_add\" :src=\"require('@/static/face.png')\" @tap=\"emogiFun\"></image>\r\n                <!-- ÂäüËÉΩÊÄßÊåâÈíÆ -->\r\n                <image class=\" icon_btn_add\" :src=\"require('@/static/add.png')\" @tap=\"switchFun\"></image>\r\n\r\n                <!-- #ifdef H5 -->\r\n                <button class=\"btn\" type=\"primary\" size=\"mini\" @touchend.prevent=\"sendMsg(null)\">ÂèëÈÄÅ</button>\r\n                <!-- #endif -->\r\n            </view>\r\n\r\n            <view class=\"fun-box\" :class=\"{'show-fun-box':showFunBtn}\">\r\n                <u-grid :col=\"4\" hover-class=\"contentType2-hover-class\" :border=\"false\" @click=\"clickGrid\">\r\n                    <u-grid-item v-for=\"(item, index) in funList\" :index=\"index\" :key=\"index\" bg-color=\"#eaeaea\">\r\n                        <u-icon :name=\"item.icon\" :size=\"52\"></u-icon>\r\n                        <view class=\"grid-text\">{{ item.title }}</view>\r\n                    </u-grid-item>\r\n                </u-grid>\r\n            </view>\r\n            <!-- Ë°®ÊÉÖÈÄâÊã© -->\r\n            <view class=\"fun-box\" :class=\"{'show-fun-box':emogiBox}\">\r\n                <swiper :current=\"swiperIndex\" style=\"height: 100%;\" @change=\"swiperChange\" :indicator-dots=\"true\">\r\n                    <swiper-item v-for=\"(items, index) in emojData\" :key=\"index\">\r\n                        <view class=\"emoj-container\">\r\n                            <view class=\"emoj-row\">\r\n                                <view class=\"emoj-parent\" v-for=\"(item, i) in items\" :key=\"i\" hover-class=\"checkActive\"\r\n                                    hover-stay-time=\"100\" @click=\"tuchEmoj(item)\">\r\n                                    <text class=\"emoj-conn\">{{ item }}</text>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                    </swiper-item>\r\n\r\n                </swiper>\r\n                <view class=\"buttonBox\" v-if=\"$u.trim(this.formData.content)\">\r\n                    <u-button size='mini' class=\"firstBut\" :custom-style=\"{background: '#fff'}\" @click=\"del\">\r\n                        <u-icon name=\"backspace\" size=\"30\" color='#000'></u-icon>\r\n                    </u-button>\r\n                    <u-button size='mini' type=\"primary\" hairline=\"false\" @click=\"sendMsg\">ÂèëÈÄÅ</u-button>\r\n                </view>\r\n            </view>\r\n            <!-- Âø´Êç∑Áî®ËØ≠ÂÖ•Âè£ -->\r\n            <QuickReply :visible=\"showQuickReply\" :item=\"selectedQuickReplyItem\" :commonList='commonList'\r\n                @dataContent=\"dataContent\" />\r\n        </view>\r\n        <!-- Âç†‰ΩçÂÖÉÁ¥†ÔºàÂêåÊ≠•Âä®ÊÄÅÈ´òÂ∫¶Ôºâ -->\r\n        <div class=\"footer-placeholder\" :style=\"{ height: dynamicFooterHeight + 'rpx' }\"></div>\r\n        </div>\r\n        <AutoComplete :visible=\"showAutoComplete\" :query=\"formData.content\" @select=\"handleSelectSuggestion\"\r\n            @close=\"handleCloseAutoComplete\" :comPleteLikst=\"comPleteLikst\" />\r\n\r\n        <!-- ËÆ¢ÂçïÂïÜÂìÅÂºπÂá∫ -->\r\n        <order-popup :visible=\"showOrderPopup\" @select=\"handleSelectOrder\" :jkid='jkId' @closeBox='closeBox'\r\n            :title='popTile' />\r\n        <!-- ÂÆ¢Êúç -->\r\n        <customer :visible=\"showcustomer\" @select=\"handleSelect\" @closeBox='closeKf'></customer>\r\n        <!-- //ËØ≠Èü≥Âä®Áîª -->\r\n        <view class=\"voice_an\" v-if=\"recording\">\r\n            <view class=\"voice_an_icon\">\r\n                <view id=\"one\" class=\"wave\"></view>\r\n                <view id=\"two\" class=\"wave\"></view>\r\n                <view id=\"three\" class=\"wave\"></view>\r\n                <view id=\"four\" class=\"wave\"></view>\r\n                <view id=\"five\" class=\"wave\"></view>\r\n                <view id=\"six\" class=\"wave\"></view>\r\n                <view id=\"seven\" class=\"wave\"></view>\r\n            </view>\r\n            <view class=\"text\">{{voiceIconText}}</view>\r\n        </view>\r\n    </view>\r\n\r\n</template>\r\n\r\n<script>\r\n    import {\r\n        LOGIN_URL\r\n    } from '../../env';\r\n    import WebSocketUtil from '@/socket.js'\r\n    import OrderPopup from '@/components/popup.vue'\r\n    import customer from '@/components/customer.vue'\r\n    import QuickReply from '@/components/QuickReply.vue';\r\n    import AutoComplete from '@/components/AutoComplete.vue';\r\n    import {\r\n        formatTime\r\n    } from '@/filter/index.js'\r\n\r\n    export default {\r\n        data() {\r\n            return {\r\n\r\n\r\n                showAutoComplete: false,\r\n                showQuickReply: false,\r\n                selectedQuickReplyItem: null,\r\n                roomType: '',\r\n                info: {},\r\n\r\n                kjList: [\r\n                ],\r\n\r\n                isHistoryLoading: false,\r\n                scrollAnimation: false,\r\n                scrollTop: 0,\r\n                scrollToView: '',\r\n                windowHeight: 0, // Âä®ÊÄÅËÆ°ÁÆóÈ´òÂ∫¶\r\n                emojData: [\r\n                    // ÂàÜÁ±ª1ÔºöÁ¨ëËÑ∏‰∏éÂºÄÂøÉË°®ÊÉÖÔºà33‰∏™Ôºâ\r\n                    [\r\n                        'üòÄ', 'üòÉ', 'üòÑ', 'üòÅ', 'üòÜ', 'üòä', 'üòá', 'üôÇ', 'üòã', 'üòé',\r\n                        'ü•≥', 'ü§©', 'ü§ó', 'üò∫', 'üò∏', 'üòπ', 'üòª', 'üòº', 'üòΩ', 'üôå',\r\n                        'üëè', 'üëç', 'üéâ', '‚ú®', 'üåü', 'üí´', '‚ù§Ô∏è', 'üíØ', '‚úÖ', 'üåà',\r\n                        'üöÄ', 'üòå',\r\n                    ],\r\n\r\n                    // ÂàÜÁ±ª2ÔºöÁà±ÂøÉ‰∏éÊµ™Êº´Ôºà33‰∏™Ôºâ\r\n                    [\r\n                        '‚ù§Ô∏è', 'üß°', 'üíõ', 'üíö', 'üíô', 'üíú', 'üñ§', 'ü§ç', 'ü§é', 'üíî',\r\n                        '‚ù£Ô∏è', 'üíï', 'üíû', 'üíì', 'üíó', 'üíñ', 'üíò', 'üíù', 'üíü', 'üíå',\r\n                        'üòç', 'ü•∞', 'üòò', 'üòó', 'üòô', 'üòö', 'üòª', 'üíã', 'Ô∏èüë®', 'üíè',\r\n                        'üë¶', 'üíê',\r\n                    ],\r\n\r\n                    // ÂàÜÁ±ª3ÔºöÊêûÊÄ™‰∏éÈ°ΩÁöÆÔºà33‰∏™Ôºâ\r\n                    [\r\n                        'üòú', 'üòù', 'üòõ', 'ü§™', 'üòè', 'üòí', 'üòî', 'üò´', 'üò©', 'üò§',\r\n                        'üò†', 'üò°', 'ü§¨', 'üòà', 'üëø', 'üíÄ', 'üëª', 'üëΩ', 'ü§ñ', 'üéÉ',\r\n                        'üò∫', 'üò∏', 'üòπ', 'üëÄ', 'üëÖ', 'üëÑ', 'ü¶∑', 'üëÇ', 'üëÉ', 'ü§°',\r\n                        'üë∫', 'üí©',\r\n                    ],\r\n\r\n                    // ÂàÜÁ±ª4ÔºöÂä®Áâ©‰∏éËá™ÁÑ∂Ôºà33‰∏™Ôºâ\r\n                    [\r\n                        'üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ',\r\n                        'ü¶Å', 'üêÆ', 'üê∑', 'üê∏', 'üêµ', 'ü¶Ñ', 'üê¥', 'üê¶', 'üêß', 'üêî',\r\n                        'üêô', 'ü¶ë', 'üê†', 'üê≥', 'üå≤', 'üå≥', 'üå¥', 'üåµ', 'üåª', 'üå∏',\r\n                        'ü¶ú', 'ü¶¢',\r\n                    ],\r\n\r\n                    // ÂàÜÁ±ª5ÔºöÂä®‰Ωú‰∏éÁâ©ÂìÅÔºà33‰∏™Ôºâ\r\n                    [\r\n                        '‚úåÔ∏è', 'ü§û', 'ü§ü', 'ü§ò', 'ü§ô', 'üëå', 'üëà', 'üëâ', 'üëÜ', 'üëá',\r\n                        'üñêÔ∏è', '‚úã', 'üëä', 'ü§õ', 'ü§ú', 'ü§ö', 'üëã', 'üññ', 'üí™', 'üéà',\r\n                        'üéÅ', 'üéÇ', 'üì±', 'üíª', '‚åö', 'üì∑', 'üéÆ', 'üí∞', 'üîë', 'üöó',\r\n                        'üõí', 'üéí',\r\n                    ]\r\n                ],\r\n                swiperIndex: 0, // ÂàùÂßã swiper Á¥¢Âºï\r\n                csHeiht: null,\r\n                selectedEmoji: null, // Áî®‰∫é‰øùÂ≠òÁî®Êà∑ÈÄâÊã©ÁöÑË°®ÊÉÖ\r\n                msgImgList: [],\r\n                historyList: [],\r\n                fromUserInfo: {},\r\n                formData: {\r\n                    content: '',\r\n                    limit: 20,\r\n                    index: 1\r\n                },\r\n                showOrderPopup: false,\r\n                showcustomer: false,\r\n                ws: null,\r\n                hosId: '',\r\n                loading: true, //Ê†áËØÜÊòØÂê¶Ê≠£Âú®Ëé∑ÂèñÊï∞ÊçÆ\r\n                hosType: '',\r\n                status: 'disconnected',\r\n                messageList: [\r\n                ],\r\n                popTile: '',\r\n                jkId: '',\r\n                infoLeft: {},\r\n                safeAreaInsetBottom: null,\r\n                loading: true, //Ê†áËØÜÊòØÂê¶Ê≠£Âú®Ëé∑ÂèñÊï∞ÊçÆ\r\n                imgHeight: '1000px',\r\n                mpInputMargin: false, //ÈÄÇÈÖçÂæÆ‰ø°Â∞èÁ®ãÂ∫è Â∫ïÈÉ®ËæìÂÖ•Ê°ÜÈ´òÂ∫¶Ë¢´È°∂Ëµ∑ÁöÑÈóÆÈ¢ò\r\n                chatType: \"voice\", // ÂõæÊ†áÁ±ªÂûã 'voice'ËØ≠Èü≥ 'keyboard'ÈîÆÁõò\r\n                voiceTitle: 'Êåâ‰Ωè ËØ¥ËØù',\r\n                commonList: [],\r\n                throttleTimeout: null,\r\n                Recorder: uni.getRecorderManager(),\r\n                Audio: uni.createInnerAudioContext(),\r\n                recording: false, //Ê†áËØÜÊòØÂê¶Ê≠£Âú®ÂΩïÈü≥\r\n                isStopVoice: false, //Âä†ÈîÅ Èò≤Ê≠¢ÁÇπÂáªËøáÂø´ÂºïËµ∑ÁöÑÂΩìÂΩïÈü≥Ê≠£Âú®ÂáÜÂ§á(ËøòÊ≤°ÊúâÂºÄÂßãÂΩïÈü≥)ÁöÑÊó∂ÂÄô,Âç¥Ë∞ÉÁî®‰∫ÜstopÊñπÊ≥ï‰ΩÜÂπ∂‰∏çËÉΩÈòªÊ≠¢ÂΩïÈü≥ÁöÑÈóÆÈ¢ò\r\n                voiceInterval: null,\r\n                voiceTime: 0, //ÊÄªÂÖ±ÂΩïÈü≥Êó∂Èïø\r\n                canSend: true, //ÊòØÂê¶ÂèØ‰ª•ÂèëÈÄÅ\r\n                PointY: 0, //ÂùêÊ†á‰ΩçÁΩÆ\r\n                voiceIconText: \"Ê≠£Âú®ÂΩïÈü≥...\",\r\n                showFunBtn: false, //ÊòØÂê¶Â±ïÁ§∫ÂäüËÉΩÂûãÊåâÈíÆ\r\n                emogiBox: false, //ÊòØÂê¶Â±ïÁ§∫Ë°®ÊÉÖÈÄâÊã©\r\n                AudioExam: null, //Ê≠£Âú®Êí≠ÊîæÈü≥È¢ëÁöÑÂÆû‰æã\r\n                selectedQuickReplyIndex: null,\r\n                comPleteLikst: [],\r\n                funList: [{\r\n                    icon: \"photo-fill\",\r\n                    title: \"ÁÖßÁâá\",\r\n                    uploadType: [\"album\"]\r\n                },\r\n                {\r\n                    icon: \"camera-fill\",\r\n                    title: \"ÊãçÊëÑ\",\r\n                    uploadType: [\"camera\"]\r\n                },\r\n                {\r\n                    icon: \"order\",\r\n                    title: \"ËÆ¢Âçï\",\r\n\r\n                },\r\n                {\r\n                    icon: \"bag-fill\",\r\n                    title: \"ÂïÜÂìÅ\",\r\n                },\r\n                {\r\n                    icon: \"kefu-ermai\",\r\n                    title: \"ÂÆ¢Êúç\"\r\n                }\r\n                ],\r\n                infoData: {}, // ÂàùÂßãÂåñ infoData\r\n                dynamicFooterHeight: 0, // ÂàùÂßãÈ´òÂ∫¶\r\n\r\n            };\r\n        },\r\n        components: {\r\n            OrderPopup,\r\n            customer,\r\n            QuickReply,\r\n            AutoComplete\r\n        },\r\n        watch: {\r\n            // ÂèñÊ∂àÈÄâ‰∏≠\r\n            showQuickReply(val) {\r\n                if (!val) {\r\n                    this.selectedQuickReplyIndex = null;\r\n                }\r\n            },\r\n            'formData.content': function (newVal, oldVal) {\r\n                this.updateFooterHeight();\r\n            },\r\n            showQuickReply(val) {\r\n\r\n                if (!val) {\r\n                    this.updateFooterHeight()\r\n\r\n                }\r\n\r\n            },\r\n            emogiBox(val) {\r\n                if (!val) {\r\n                    this.updateFooterHeight()\r\n\r\n                }\r\n            },\r\n            showFunBtn(val) {\r\n                if (!val) {\r\n                    this.updateFooterHeight()\r\n\r\n                }\r\n            }\r\n            // ÂÖ∂‰ªñÁõëÂê¨Âô®...\r\n        },\r\n\r\n        mounted() {\r\n\r\n\r\n        },\r\n        methods: {\r\n            // ËΩ¨Êç¢ÂáΩÊï∞\r\n            convertTimestampsToDates(dataArray, key = 'create_time') {\r\n\r\n\r\n                return dataArray.map(item => {\r\n\r\n                    return {\r\n                        ...item,\r\n                        [key]: formatTime(item[key]), // ËΩ¨Êç¢Êó∂Èó¥Êà≥\r\n                    };\r\n                });\r\n            },\r\n\r\n            updateFooterHeight(num) {\r\n                // ‰ΩøÁî® UniApp API Ëé∑ÂèñËäÇÁÇπÈ´òÂ∫¶\r\n                this.$nextTick(() => {\r\n                    const query = uni.createSelectorQuery().in(this);\r\n                    query.select('.input-box-flex').boundingClientRect(res => {\r\n                        if (res) {\r\n                            let heightInPx = res.height;\r\n                            let heightInRpx = this.px2rpx(heightInPx);\r\n                            if (num) {\r\n                                this.dynamicFooterHeight = heightInRpx + num;\r\n                            } else {\r\n                                this.dynamicFooterHeight = heightInRpx;\r\n                            }\r\n\r\n\r\n                        }\r\n                    }).exec();\r\n                });\r\n            },\r\n            // ËΩ¨Êç¢px\r\n            px2rpx(px) {\r\n                const screenWidth = uni.getSystemInfoSync().screenWidth;\r\n                return (750 / screenWidth) * px;\r\n            },\r\n            handleInput(e) {\r\n\r\n\r\n\r\n\r\n                if (this.throttleTimeout) {\r\n                    clearTimeout(this.throttleTimeout);\r\n                }\r\n                this.throttleTimeout = setTimeout(() => {\r\n\r\n                    if (!(e.target.value.trim().length === 0)) {\r\n                        this.autoComplete(this.jkId, e.target.value);\r\n\r\n                    }\r\n\r\n\r\n\r\n                    // this.showAutoComplete = !!this.formData.content;\r\n                }, 300); // 300 ÊØ´ÁßíÁöÑËäÇÊµÅÊó∂Èó¥\r\n\r\n\r\n            },\r\n            //Ê®°Á≥äÊêúÁ¥¢\r\n            autoComplete(val, content) {\r\n                return new Promise((resolve, reject) => {\r\n                    this.$api('autoComplete', {\r\n                        client_id: val,\r\n                        keywords: content\r\n                    }).then(res => {\r\n                        if (res.status == 200) {\r\n\r\n                            if (res.data) {\r\n                                this.showAutoComplete = true\r\n                                this.comPleteLikst = res.data.list\r\n                            } else {\r\n                                this.showAutoComplete = false\r\n                            }\r\n\r\n\r\n                        }\r\n                        resolve(true);\r\n                    }).catch((e) => {\r\n                        resolve(false);\r\n                        // console.log(e);\r\n                    });\r\n                })\r\n            },\r\n            handleSelectSuggestion(item) {\r\n\r\n\r\n                this.formData.content = item;\r\n                this.showAutoComplete = false;\r\n                this.$nextTick(() => {\r\n                    this.updateFooterHeight();\r\n                    // ÊàñÈÄöËøá‰∫ã‰ª∂Ëß¶Âèë\r\n\r\n                });\r\n\r\n            },\r\n            handleCloseAutoComplete() {\r\n                this.showAutoComplete = false;\r\n            },\r\n            //Ëé∑Âèñ‰º†ÈÄíÁöÑÊñáÂ≠ó\r\n            dataContent(data) {\r\n                console.log(data);\r\n                this.formData.content = data\r\n\r\n            },\r\n            //Ëé∑ÂèñÂàÜÁ±ª\r\n            getList(val) {\r\n                console.log(val);\r\n\r\n                return new Promise((resolve, reject) => {\r\n                    this.$api('getCateList', {\r\n                        client_id: val\r\n                    }).then(res => {\r\n                        if (res.status == 200) {\r\n                            this.kjList = res.data.common_list\r\n                            this.commonList = res.data.cate_list\r\n                            console.log(this.commonList);\r\n\r\n                        }\r\n                        resolve(true);\r\n                    }).catch((e) => {\r\n                        resolve(false);\r\n                        // console.log(e);\r\n                    });\r\n                })\r\n            },\r\n            scrollBool() {\r\n                this.showQuickReply = false;\r\n                this.showFunBtn = false\r\n                this.emogiBox = false\r\n                uni.hideKeyboard()\r\n\r\n            },\r\n            handleQuickReplyClick(item, index) {\r\n                this.updateFooterHeight(600);\r\n                this.emogiBox = false;\r\n                this.showFunBtn = false;\r\n                this.scrollToView = 'msg-0';\r\n                if (index === 0) {\r\n                    if (this.selectedQuickReplyIndex === index) {\r\n                        this.selectedQuickReplyIndex = null;\r\n\r\n                        this.showQuickReply = false;\r\n                    } else {\r\n                        this.selectedQuickReplyIndex = index;\r\n                        this.selectedQuickReplyItem = item;\r\n                        this.showQuickReply = true;\r\n                    }\r\n                } else {\r\n\r\n                    this.formData.content = item.content;\r\n\r\n                    this.selectedQuickReplyIndex = null; // ÁÇπÂáªÂÖ∂‰ªñÈ°πÊó∂‰∏çÈ´ò‰∫Æ\r\n                }\r\n            },\r\n            del() {\r\n\r\n                let arr = Array.from(this.formData.content); // ÊåâÂ≠óÁ¨¶ÊãÜÂàÜ‰∏∫Êï∞ÁªÑ\r\n                arr = arr.slice(0, -1); // Âà†Èô§ÊúÄÂêé‰∏Ä‰∏™Â≠óÁ¨¶\r\n                this.formData.content = arr.join('');\r\n                console.log(this.formData.content);\r\n            },\r\n            //Ëß¶ÂèëÊªëÂä®Âà∞È°∂ÈÉ®(Âä†ËΩΩÂéÜÂè≤‰ø°ÊÅØËÆ∞ÂΩï)\r\n            loadHistory(e) {\r\n\r\n                if (this.isHistoryLoading) {\r\n                    return;\r\n                }\r\n                this.isHistoryLoading = true; //ÂèÇÊï∞‰Ωú‰∏∫ËøõÂÖ•ËØ∑Ê±ÇÊ†áËØÜÔºåÈò≤Ê≠¢ÈáçÂ§çËØ∑Ê±Ç\r\n                this.scrollAnimation = false; //ÂÖ≥Èó≠ÊªëÂä®Âä®Áîª\r\n                // let Viewid = this.messageList[0].msg.id;//ËÆ∞‰ΩèÁ¨¨‰∏Ä‰∏™‰ø°ÊÅØID\r\n                //Êú¨Âú∞Ê®°ÊãüËØ∑Ê±ÇÂéÜÂè≤ËÆ∞ÂΩïÊïàÊûú\r\n                setTimeout(() => {\r\n                    // Ê∂àÊÅØÂàóË°®\r\n\r\n                    // Ëé∑ÂèñÊ∂àÊÅØ‰∏≠ÁöÑÂõæÁâá,Âπ∂Â§ÑÁêÜÊòæÁ§∫Â∞∫ÂØ∏\r\n                    for (let i = 0; i < this.historyList.length; i++) {\r\n\r\n                        this.historyList[i].hasBeenSentId = Math.floor(Math.random() * 1000 + 1);\r\n                        this.messageList.unshift(this.historyList[i]);\r\n                    }\r\n                    //ËøôÊÆµ‰ª£Á†ÅÂæàÈáçË¶ÅÔºå‰∏çÁÑ∂ÊØèÊ¨°Âä†ËΩΩÂéÜÂè≤Êï∞ÊçÆÈÉΩ‰ºöË∑≥Âà∞È°∂ÈÉ®\r\n                    this.$nextTick(function () {\r\n                        this.scrollToView = 'msg-19'\r\n                        this.$nextTick(function () {\r\n                            this.scrollAnimation = true; //ÊÅ¢Â§çÊªöÂä®Âä®Áîª\r\n                        });\r\n\r\n                    });\r\n                    this.isHistoryLoading = false;\r\n\r\n                }, 1000)\r\n            },\r\n\r\n            //Â§ÑÁêÜÂõæÁâáÂ∞∫ÂØ∏ÔºåÂ¶ÇÊûú‰∏çÂ§ÑÁêÜÂÆΩÈ´òÔºåÊñ∞ËøõÂÖ•È°µÈù¢Âä†ËΩΩÂõæÁâáÊó∂ÂÄô‰ºöÈó™\r\n            setPicSize(content) {\r\n                // ËÆ©ÂõæÁâáÊúÄÈïøËæπÁ≠â‰∫éËÆæÁΩÆÁöÑÊúÄÂ§ßÈïøÂ∫¶ÔºåÁü≠ËæπÁ≠âÊØî‰æãÁº©Â∞èÔºåÂõæÁâáÊéß‰ª∂ÁúüÂÆûÊîπÂèòÔºåÂå∫Âà´‰∫éaspectFitÊñπÂºè„ÄÇ\r\n                let maxW = uni.upx2px(350); //350ÊòØÂÆö‰πâÊ∂àÊÅØÂõæÁâáÊúÄÂ§ßÂÆΩÂ∫¶\r\n                let maxH = uni.upx2px(350); //350ÊòØÂÆö‰πâÊ∂àÊÅØÂõæÁâáÊúÄÂ§ßÈ´òÂ∫¶\r\n                if (content.w > maxW || content.h > maxH) {\r\n                    let scale = content.w / content.h;\r\n                    content.w = scale > 1 ? maxW : maxH * scale;\r\n                    content.h = scale > 1 ? maxW / scale : maxH;\r\n                }\r\n                return content;\r\n            },\r\n            //ÈÄâ‰∏≠ËÆ¢Âçï\r\n            handleSelectOrder(item) {\r\n\r\n                this.sendMsg(item)\r\n\r\n                // Ë∑≥ËΩ¨Âà∞ËÆ¢ÂçïËØ¶ÊÉÖÈ°µÊàñÂÖ∂‰ªñÊìç‰Ωú\r\n            },\r\n            //ËΩ¨Êé•ÂÆ¢Êúç\r\n            handleSelect(item) {\r\n\r\n            },\r\n            //ÂÖ≥Èó≠\r\n            closeBox(data) {\r\n\r\n                this.showOrderPopup = data\r\n            },\r\n            closeKf(data) {\r\n\r\n                this.showcustomer = data\r\n            },\r\n            init(data) {\r\n                // ÂàùÂßãÂåñ WebSocket\r\n                this.ws = new WebSocketUtil('wss://192.168.0.119:8088/ws/', {\r\n                    maxReconnect: 5, // ÊúÄÂ§ßÈáçËøûÊ¨°Êï∞\r\n                    reconnectDelay: 2000, // ÈáçËøûÈó¥Èöî\r\n                    heartbeatInterval: 100000 // ÂøÉË∑≥Èó¥Èöî\r\n                });\r\n\r\n                // ÁõëÂê¨‰∫ã‰ª∂\r\n                this.ws.on('open', () => {\r\n\r\n                    this.status = 'connected'\r\n                });\r\n                this.ws.send(data)\r\n                this.ws.startHeartbeat(data)\r\n                this.ws.on('close', () => this.status = 'disconnected');\r\n                this.ws.on('error', (err) => console.error('ÂèëÁîüÈîôËØØ:', err));\r\n                this.ws.on('message', (res) => {\r\n                    console.log(res);\r\n\r\n                    if (res.type == 'onConnect') {\r\n\r\n                        this.jkId = res.data.client_id\r\n                        this.gethistoryList(this.jkId)\r\n\r\n                    }\r\n                    if (res.type == 'dialog') {\r\n                        res.data.is_me = false\r\n                        this.messageList.push(res.data)\r\n                        this.scrollToView = 'msg-0';\r\n                    }\r\n                    if (res.type == 'login') {\r\n\r\n                        this.messageList = this.convertTimestampsToDates(res.data.list);\r\n                        this.info = res.data.sender_info\r\n\r\n                        this.messageList.map(\r\n                            (i, index) => {\r\n                                i.path = i.content\r\n                                i.hasBeenSentId = this.messageList.length - 1 - index\r\n                                if (i.is_me) {\r\n                                    i.is_me = true\r\n                                } else {\r\n                                    i.is_me = false\r\n                                }\r\n\r\n                            }\r\n\r\n\r\n                        )\r\n\r\n                    }\r\n\r\n\r\n\r\n                });\r\n            },\r\n\r\n            // Âä†ËΩΩÂéÜÂè≤Ê∂àÊÅØ\r\n            gethistoryList(page) {\r\n\r\n                return new Promise((resolve, reject) => {\r\n                    this.$api('history', {\r\n                        client_id: page\r\n                    }).then(res => {\r\n\r\n                        if (res.status == 200) {\r\n                            this.historyList = res.data.list\r\n                        }\r\n                        resolve(true);\r\n                    }).catch((e) => {\r\n\r\n                        resolve(false);\r\n                        // console.log(e);\r\n                    });\r\n                })\r\n\r\n            },\r\n\r\n\r\n\r\n\r\n\r\n\r\n            //ÂàáÊç¢ËØ≠Èü≥ÊàñËÄÖÈîÆÁõòÊñπÂºè\r\n            switchChatType(type) {\r\n\r\n                this.chatType = type;\r\n                this.showFunBtn = false;\r\n            },\r\n            //ÊâìÂºÄË°®ÊÉÖÈÄâÈ°π\r\n            emogiFun() {\r\n                this.chatType = 'voice'\r\n                this.emogiBox = !this.emogiBox;\r\n                this.showFunBtn = false;\r\n                this.showQuickReply = false;\r\n                this.scrollToView = 'msg-0';\r\n                uni.hideKeyboard();\r\n                // this.scrollToView = 'msg-0';\r\n                this.updateFooterHeight(300)\r\n\r\n\r\n            },\r\n            //ÂàáÊç¢ÂäüËÉΩÊÄßÊåâÈíÆ\r\n            switchFun() {\r\n                this.updateFooterHeight(300)\r\n                this.chatType = 'voice'\r\n                this.showFunBtn = !this.showFunBtn;\r\n                this.emogiBox = false\r\n                this.showQuickReply = false;\r\n                uni.hideKeyboard()\r\n\r\n            },\r\n            tuchEmoj(item) {\r\n                this.formData.content += item\r\n\r\n            },\r\n            swiperChange(e) {\r\n                this.swiperIndex = e.detail.current;\r\n            },\r\n\r\n\r\n            //ÂèëÈÄÅÊ∂àÊÅØ\r\n            sendMsg(data) {\r\n\r\n                const sedData = {\r\n                    token: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE3NDEwNzQ4ODUsImV4cCI6MTc0MzY2Njg4NSwiZGF0YSI6eyJ1c2VyX3R5cGUiOiJ1c2VyIiwidXNlcl9pZCI6NDd9fQ.Ave2qlEte478fxGKlAD_Zbicmx-o27HG3LEnhHVoRLk\",\r\n                    type: 'dialog',\r\n                    shop_id: null,\r\n                    user_id: null,\r\n                    content_type: 1,\r\n                    content: this.formData.content,\r\n                    room_type: this.hosType\r\n\r\n                }\r\n                if (this.hosType === 1 || this.hosType === 2 || this.hosType === 3) {\r\n                    sedData.shop_id = this.hosId\r\n\r\n                } else {\r\n                    sedData.user_id = this.hosId\r\n                }\r\n\r\n\r\n                if (data) {\r\n                    if (data.contentType == 3) {\r\n                        //ËØ¥ÊòéÊòØÂèëÈÄÅËßÜÈ¢ë\r\n                        sedData.path = data.path\r\n                        sedData.content = data.content;\r\n                        sedData.content_type = data.contentType;\r\n\r\n                    } else if (data.contentType == 2) {\r\n                        //ÂèëÈÄÅÂõæÁâá\r\n                        sedData.path = data.path\r\n                        sedData.content = data.content;\r\n                        sedData.content_type = data.contentType;\r\n\r\n\r\n                    } else if (data.contentType == 4) {\r\n                        //ÂïÜÂìÅ\r\n                        sedData.content = data.id\r\n                        sedData.content_type = data.contentType;\r\n                        sedData.thumb_url = data.thumb_url\r\n                        sedData.title = data.title\r\n                        sedData.price = data.price\r\n\r\n                    } else if (data.contentType == 5) {\r\n                        //ËÆ¢Âçï\r\n                        sedData.content = data.fatherId + ':' + data.id\r\n                        sedData.content_type = data.contentType;\r\n                        sedData.thumb_url = data.thumb_url\r\n                        sedData.title = data.title\r\n                        sedData.price = data.price\r\n                        sedData.order_number = data.order_number\r\n                        sedData.order_time = data.order_time\r\n                        sedData.shop_title = data.shop_title\r\n                        sedData.num = data.num\r\n\r\n\r\n                    }\r\n                } else if (!this.$u.trim(this.formData.content)) {\r\n                    //È™åËØÅËæìÂÖ•Ê°Ü‰π¶Âê¶‰∏∫Á©∫Â≠óÁ¨¶‰º†\r\n                    return;\r\n                }\r\n\r\n                this.ws.send(sedData)\r\n\r\n                sedData.is_me = true,\r\n\r\n                    sedData.headimgurl = this.info.headimgurl\r\n                this.messageList.push(sedData);\r\n                this.messageList.map(\r\n                    (i, index) => {\r\n                        i.hasBeenSentId = this.messageList.length - 1 - index\r\n                    }\r\n\r\n                )\r\n\r\n                this.$nextTick(() => {\r\n                    // this.dynamicFooterHeight = this.csHeiht\r\n                    this.formData.content = '';\r\n                    // #ifdef MP-WEIXIN\r\n\r\n                    this.scrollToView = 'msg-0'\r\n                    // #endif\r\n\r\n                    // #ifndef MP-WEIXIN\r\n                    this.scrollToView = 'msg-0'\r\n                    // #endif\r\n\r\n                    if (this.showFunBtn) {\r\n                        this.showFunBtn = false;\r\n                    }\r\n\r\n                    // #ifdef MP-WEIXIN \r\n                    if (sedData.contentType == 1) {\r\n                        this.mpInputMargin = true;\r\n                    }\r\n                    // #endif\r\n                    //h5ÊµèËßàÂô®Âπ∂Ê≤°ÊúâÂæàÂ•ΩÁöÑÂäûÊ≥ïÊéßÂà∂ÈîÆÁõò‰∏ÄÁõ¥Â§Ñ‰∫éÂî§Ëµ∑Áä∂ÊÄÅ ËÄå‰∏î‰ºöÊúâÊ†∑ÂºèÊÄßÁöÑÈóÆÈ¢ò\r\n                    // #ifdef H5\r\n                    uni.hideKeyboard();\r\n                    // #endif\r\n                });\r\n            },\r\n\r\n\r\n            //Áî®Êà∑Ëß¶Êë∏Â±èÂπïÁöÑÊó∂ÂÄôÈöêËóèÈîÆÁõò\r\n            touchstart() {\r\n                uni.hideKeyboard();\r\n                this.showFunBtn = false\r\n                this.emogiBox = false\r\n\r\n            },\r\n            // userid Áî®Êà∑id\r\n            linkToBusinessCard(userId) {\r\n                // this.$u.route({\r\n                // \turl: 'pages/businessCard/businessCard',\r\n                // \tparams: {\r\n                // \t\tuserId\r\n                // \t}\r\n                // });\r\n            },\r\n            //ÂáÜÂ§áÂºÄÂßãÂΩïÈü≥\r\n            startVoice(e) {\r\n                if (!this.Audio.paused) {\r\n                    //Â¶ÇÊûúÈü≥È¢ëÊ≠£Âú®Êí≠Êîæ ÂÖàÊöÇÂÅú„ÄÇ\r\n                    this.stopAudio(this.AudioExam)\r\n                }\r\n                this.recording = true;\r\n                this.isStopVoice = false;\r\n                this.canSend = true;\r\n                this.voiceIconText = \"Ê≠£Âú®ÂΩïÈü≥...\"\r\n                this.PointY = e.touches[0].clientY;\r\n                this.Recorder.start({\r\n                    format: 'mp3'\r\n                });\r\n            },\r\n            //ÂΩïÈü≥Â∑≤ÁªèÂºÄÂßã\r\n            beginVoice() {\r\n                if (this.isStopVoice) {\r\n                    this.Recorder.stop();\r\n                    return;\r\n                }\r\n                this.voiceTitle = 'ÊùæÂºÄ ÁªìÊùü'\r\n                this.voiceInterval = setInterval(() => {\r\n                    this.voiceTime++;\r\n                }, 1000)\r\n            },\r\n            //move Ê≠£Âú®ÂΩïÈü≥‰∏≠\r\n            moveVoice(e) {\r\n                const PointY = e.touches[0].clientY\r\n                const slideY = this.PointY - PointY;\r\n                if (slideY > uni.upx2px(120)) {\r\n                    this.canSend = false;\r\n                    this.voiceIconText = 'ÊùæÂºÄÊâãÊåá ÂèñÊ∂àÂèëÈÄÅ '\r\n                } else if (slideY > uni.upx2px(60)) {\r\n                    this.canSend = true;\r\n                    this.voiceIconText = 'ÊâãÊåá‰∏äÊªë ÂèñÊ∂àÂèëÈÄÅ '\r\n                } else {\r\n                    this.voiceIconText = 'Ê≠£Âú®ÂΩïÈü≥... '\r\n                }\r\n            },\r\n            //ÁªìÊùüÂΩïÈü≥\r\n            endVoice() {\r\n                this.isStopVoice = true; //Âä†ÈîÅ Á°Æ‰øùÂ∑≤ÁªèÁªìÊùüÂΩïÈü≥Âπ∂‰∏ç‰ºöÂΩïÂà∂\r\n                this.Recorder.stop();\r\n                this.voiceTitle = 'Êåâ‰Ωè ËØ¥ËØù'\r\n            },\r\n            //ÂΩïÈü≥Ë¢´ÊâìÊñ≠\r\n            cancelVoice(e) {\r\n                this.voiceTime = 0;\r\n                this.voiceTitle = 'Êåâ‰Ωè ËØ¥ËØù';\r\n                this.canSend = false;\r\n                this.Recorder.stop();\r\n            },\r\n            //Â§ÑÁêÜÂΩïÈü≥Êñá‰ª∂\r\n            handleRecorder({\r\n                tempFilePath,\r\n                duration\r\n            }) {\r\n                let contentDuration;\r\n                // #ifdef MP-WEIXIN\r\n                this.voiceTime = 0;\r\n                if (duration < 600) {\r\n                    this.voiceIconText = \"ËØ¥ËØùÊó∂Èó¥ËøáÁü≠\";\r\n                    setTimeout(() => {\r\n                        this.recording = false;\r\n                    }, 200)\r\n                    return;\r\n                }\r\n                contentDuration = duration / 1000;\r\n                // #endif\r\n\r\n                // #ifdef APP-PLUS\r\n                contentDuration = this.voiceTime + 1;\r\n                this.voiceTime = 0;\r\n                if (contentDuration <= 0) {\r\n                    this.voiceIconText = \"ËØ¥ËØùÊó∂Èó¥ËøáÁü≠\";\r\n                    setTimeout(() => {\r\n                        this.recording = false;\r\n                    }, 200)\r\n                    return;\r\n                };\r\n                // #endif\r\n\r\n                this.recording = false;\r\n                const params = {\r\n                    contentType: 2,\r\n                    content: tempFilePath,\r\n                    contentDuration: Math.ceil(contentDuration)\r\n                };\r\n                this.canSend && this.sendMsg(params);\r\n            },\r\n            //ÊéßÂà∂Êí≠ÊîæËøòÊòØÊöÇÂÅúÈü≥È¢ëÊñá‰ª∂\r\n            handleAudio(item) {\r\n                this.AudioExam = item;\r\n                this.Audio.paused ? this.playAudio(item) : this.stopAudio(item);\r\n            },\r\n            //Êí≠ÊîæÈü≥È¢ë\r\n            playAudio(item) {\r\n                this.Audio.src = item.content;\r\n                this.Audio.hasBeenSentId = item.hasBeenSentId;\r\n                this.Audio.play();\r\n                item.anmitionPlay = true;\r\n            },\r\n            //ÂÅúÊ≠¢Èü≥È¢ë\r\n            stopAudio(item) {\r\n                item.anmitionPlay = false;\r\n                this.Audio.src = '';\r\n                this.Audio.stop();\r\n            },\r\n            //ÂÖ≥Èó≠Âä®Áîª\r\n            closeAnmition() {\r\n                const hasBeenSentId = this.Audio.hasBeenSentId;\r\n                const item = this.messageList.find(it => it.hasBeenSentId == hasBeenSentId);\r\n                item.anmitionPlay = false;\r\n            },\r\n            //ÁÇπÂáªÂÆ´Ê†ºÊó∂Ëß¶Âèë\r\n            clickGrid(index) {\r\n                if (index == 0) {\r\n                    this.chooseImage(['album'])\r\n                } else if (index == 1) {\r\n                    this.chooseImage(['camera'])\r\n                } else if (index == 2) {\r\n\r\n                    this.showFunBtn = false;\r\n                    this.popTile = 'ËØ∑ÈÄâÊã©ÈúÄË¶ÅÂí®ËØ¢ÁöÑËÆ¢Âçï'\r\n                    this.showOrderPopup = true\r\n                } else if (index == 3) {\r\n\r\n                    this.showFunBtn = false;\r\n                    this.showOrderPopup = true\r\n                    this.popTile = 'ÂèëÈÄÅÂïÜÂìÅ'\r\n                } else if (index == 4) {\r\n                    let parmas = {\r\n                        token: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE3NDEwNzQ4ODUsImV4cCI6MTc0MzY2Njg4NSwiZGF0YSI6eyJ1c2VyX3R5cGUiOiJ1c2VyIiwidXNlcl9pZCI6NDd9fQ.Ave2qlEte478fxGKlAD_Zbicmx-o27HG3LEnhHVoRLk\",\r\n                        type: \"cs_list\",\r\n                        room_type: this.hosType\r\n                    }\r\n                    this.ws.send(parmas)\r\n                    this.showFunBtn = false;\r\n                    this.showcustomer = true\r\n                }\r\n            },\r\n            //ÂèëÈÄÅÂõæÁâá\r\n            chooseImage(sourceType) {\r\n                uni.chooseMedia({\r\n                    count: 9,\r\n                    mediaType: ['image', 'video'], // ÂÖÅËÆ∏ÂõæÁâáÂíåËßÜÈ¢ë\r\n                    sourceType: sourceType,\r\n                    maxDuration: 15,\r\n                    success: (res) => {\r\n                        const files = res.tempFiles;\r\n\r\n                        this.uploadFiles(files, res.type);\r\n                    }\r\n                });\r\n\r\n            },\r\n            // ÈÄâÊã©ÂõæÁâáÂêéË∞ÉÁî®Ê≠§ÊñπÊ≥ï\r\n            uploadFiles(tempFilePath, type) {\r\n\r\n                // Âπ≥Âè∞Âà§Êñ≠\r\n                // #ifdef H5\r\n                this.uploadImageInH5(tempFilePath);\r\n                // #endif\r\n\r\n                // #ifdef MP-WEIXIN || MP-ALIPAY\r\n                this.uploadImageInMiniProgram(tempFilePath, type);\r\n                // #endif\r\n            },\r\n            // H5 Á´ØÂ§ÑÁêÜ\r\n            async uploadImageInH5(tempFilePath) {\r\n                try {\r\n                    // 1. Â∞Ü Blob URL ËΩ¨Êç¢‰∏∫ File ÂØπË±°\r\n                    const response = await fetch(tempFilePath);\r\n                    const blob = await response.blob();\r\n                    const file = new File([blob], 'image.jpg', {\r\n                        type: blob.type\r\n                    });\r\n\r\n                    // 2. ÊûÑÈÄ† FormData\r\n                    const formData = new FormData();\r\n                    formData.append('file', file); // Êñá‰ª∂Â≠óÊÆµ\r\n                    formData.append('userId', '123'); // ÂÖ∂‰ªñÂèÇÊï∞\r\n\r\n                    // 3. ÂèëÈÄÅËØ∑Ê±ÇÔºà‰ΩøÁî® uni.request ÊàñÂéüÁîü fetchÔºâ\r\n                    const result = await this.sendFormDataRequest(formData);\r\n                    console.log('‰∏ä‰º†ÊàêÂäü:', result);\r\n                } catch (err) {\r\n                    console.error('H5Á´Ø‰∏ä‰º†Â§±Ë¥•:', err);\r\n                }\r\n            },\r\n            // Â∞èÁ®ãÂ∫èÁ´ØÂ§ÑÁêÜ\r\n            uploadImageInMiniProgram(tempFilePath, type) {\r\n\r\n                const uploadTasks = tempFilePath.map(file => {\r\n\r\n                    return new Promise((resolve, reject) => {\r\n                        uni.uploadFile({\r\n                            url: 'http://192.168.0.119:8080/upload/upload2Oss',\r\n                            filePath: file.tempFilePath,\r\n                            name: 'file', // ÂèÇÊï∞ÂêçÈúÄ‰∏éÂêéÁ´Ø‰∏ÄËá¥\r\n                            header: {\r\n                                'Authorization': \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE3NDEwNzQ4ODUsImV4cCI6MTc0MzY2Njg4NSwiZGF0YSI6eyJ1c2VyX3R5cGUiOiJ1c2VyIiwidXNlcl9pZCI6NDd9fQ.Ave2qlEte478fxGKlAD_Zbicmx-o27HG3LEnhHVoRLk\"\r\n\r\n                            },\r\n                            formData: {\r\n                                client_id: this.jkId\r\n                            },\r\n                            success: (res) => {\r\n                                if (res.statusCode === 200) {\r\n                                    try {\r\n                                        const data = JSON.parse(res.data);\r\n\r\n                                        this.sendMsg({\r\n                                            contentType: type == 'image' ? 2 : 3,\r\n                                            content: data.data.list[0],\r\n                                            path: file.tempFilePath\r\n                                        })\r\n\r\n                                    } catch (e) {\r\n                                        reject(new Error('Ëß£ÊûêÂìçÂ∫îÂ§±Ë¥•'));\r\n                                    }\r\n                                } else {\r\n                                    reject(new Error(`‰∏ä‰º†Â§±Ë¥•ÔºåÁä∂ÊÄÅÁ†ÅÔºö${res.statusCode}`));\r\n                                }\r\n                            },\r\n                            fail: (err) => {\r\n                                reject(err);\r\n                            }\r\n                        });\r\n                    });\r\n                });\r\n\r\n                // ÂêàÂπ∂ÊâÄÊúâÁªìÊûú\r\n                Promise.all(uploadTasks)\r\n                    .then(results => {\r\n                        const allList = results.flat(); // ÂêàÂπ∂ÊàêÂÆåÊï¥Ë∑ØÂæÑÊï∞ÁªÑ\r\n                        console.log('‰∏ä‰º†ÊàêÂäüÔºåÊñá‰ª∂ÂàóË°®Ôºö', allList);\r\n\r\n\r\n\r\n                    })\r\n                    .catch(error => {\r\n                        console.error('‰∏ä‰º†Âá∫ÈîôÔºö', error);\r\n                        uni.showToast({\r\n                            title: '‰∏ä‰º†Â§±Ë¥•',\r\n                            icon: 'none'\r\n                        });\r\n                    });\r\n\r\n            },\r\n            //Êü•ÁúãÂ§ßÂõæ\r\n            viewImg(imgList) {\r\n                uni.previewImage({\r\n                    urls: imgList,\r\n                    // #ifndef MP-WEIXIN\r\n                    indicator: 'number'\r\n                    // #endif\r\n                });\r\n            },\r\n        },\r\n        onPageScroll(e) {\r\n\r\n            // this.messageList = [...this.historyList , ...this.messageList];\r\n            // this.messageList.push({content:'222'})\r\n        },\r\n\r\n\r\n        onNavigationBarButtonTap({\r\n            index\r\n        }) {\r\n            if (index == 0) {\r\n                //Áî®Êà∑ËØ¶ÊÉÖ ËÆæÁΩÆ\r\n            } else if (index == 1) {\r\n\r\n                //ËøîÂõûÊåâÈíÆ\r\n                this.$u.route({\r\n                    type: 'switchTab',\r\n                    url: 'pages/home/home'\r\n                });\r\n            }\r\n        },\r\n        //ËøîÂõûÊåâÈíÆ‰∫ã‰ª∂\r\n        onBackPress(e) {\r\n            //‰ª•‰∏ãÂÜÖÂÆπÂØπh5‰∏çÁîüÊïà\r\n            //--ÊâÄ‰ª•Â¶ÇÊûúÁî®ÊµèËßàÂô®Ëá™Â∏¶ÁöÑËøîÂõûÊåâÈíÆËøõË°åËøîÂõûÁöÑÊó∂ÂÄôÈ°µÈù¢‰∏ç‰ºöÈáçÂÆöÂêë Ê≠£Âú®ÂØªÊâæÂêàÈÄÇÁöÑËß£ÂÜ≥ÊñπÊ°à\r\n            this.$u.route({\r\n                type: 'switchTab',\r\n                url: 'pages/home/home'\r\n            });\r\n            return true;\r\n        },\r\n        onUnload() {\r\n            const params = {\r\n                room_type: this.roomType,\r\n                type: \"logout\",\r\n                token: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE3NDEwNzQ4ODUsImV4cCI6MTc0MzY2Njg4NSwiZGF0YSI6eyJ1c2VyX3R5cGUiOiJ1c2VyIiwidXNlcl9pZCI6NDd9fQ.Ave2qlEte478fxGKlAD_Zbicmx-o27HG3LEnhHVoRLk\"\r\n            }\r\n            this.ws.send(params)\r\n\r\n            if (this.ws) {\r\n                this.ws.close()\r\n            }\r\n        },\r\n\r\n        onLoad(info) {\r\n\r\n\r\n            const query = uni.createSelectorQuery().in(this);\r\n            query.select('.input-box-flex').boundingClientRect(res => {\r\n                if (res) {\r\n\r\n                    this.csHeiht = res.height\r\n                    let csHeiht = this.px2rpx(csHeiht); // Â∞Ü px ËΩ¨Êç¢‰∏∫ rpx\r\n                }\r\n            }).exec();\r\n\r\n\r\n            uni.getSystemInfo({\r\n                success: (res) => {\r\n                    // Ëé∑ÂèñÂÆâÂÖ®Âå∫ÂüüÂ∫ïÈÉ®ÊèíÂÖ•ÂÄº\r\n                    const safeAreaInsetBottom = res.safeAreaInsets ? res.safeAreaInsets.bottom : 0;\r\n                    console.log('Safe Area Inset Bottom:', safeAreaInsetBottom);\r\n\r\n                    // Âú®ËøôÈáåÂèØ‰ª•‰ΩøÁî® safeAreaInsetBottom ÁöÑÂÄº\r\n                    this.safeAreaInsetBottom = safeAreaInsetBottom;\r\n\r\n                }\r\n            });\r\n\r\n\r\n\r\n            const infoData = JSON.parse(info.data)\r\n            uni.setNavigationBarTitle({\r\n                title: infoData.title\r\n            });\r\n            this.roomType = infoData.room_type\r\n            const params = {\r\n\r\n                user_id: null,\r\n                shop_id: null,\r\n                room_type: infoData.room_type,\r\n                type: \"login\",\r\n                token: \"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpYXQiOjE3NDEzMzQ1MTUsImV4cCI6MTc0MzkyNjUxNSwiZGF0YSI6eyJ1c2VyX3R5cGUiOiJhZG1pbiIsImFkbWluX3VpZCI6MX19.fZwFbBkcbc4yv_FiGM6kSZ97L9eBNzFt7cAZZ-NR7H8\"\r\n            }\r\n            this.hosType = infoData.room_type\r\n            if (infoData.room_type === 1 || infoData.room_type === 2 || infoData.room_type === 3) {\r\n                params.shop_id = infoData.shop_id\r\n                this.hosId = infoData.shop_id\r\n            } else {\r\n                params.user_id = infoData.user_id\r\n                this.hosId = infoData.user_id\r\n            }\r\n\r\n            this.infoData = infoData; // ËµãÂÄº infoData\r\n\r\n            this.init(params)\r\n            this.$nextTick(() => {\r\n                this.getList(this.jkId)\r\n                //ËøõÂÖ•È°µÈù¢ÊªöÂä®Âà∞Â∫ïÈÉ®\r\n                this.scrollTop = 99999999\r\n                this.updateFooterHeight();\r\n            })\r\n\r\n\r\n\r\n            //ÂΩïÈü≥ÂºÄÂßã‰∫ã‰ª∂\r\n            this.Recorder.onStart(e => {\r\n\r\n                this.beginVoice();\r\n            });\r\n            //ÂΩïÈü≥ÁªìÊùü‰∫ã‰ª∂\r\n            this.Recorder.onStop(res => {\r\n                clearInterval(this.voiceInterval);\r\n                this.handleRecorder(res);\r\n            });\r\n\r\n            //Èü≥È¢ëÂÅúÊ≠¢‰∫ã‰ª∂\r\n            this.Audio.onStop(e => {\r\n                this.closeAnmition();\r\n            });\r\n\r\n            //Èü≥È¢ëÊí≠ÊîæÁªìÊùü‰∫ã‰ª∂\r\n            this.Audio.onEnded(e => {\r\n                this.closeAnmition();\r\n            });\r\n        },\r\n        onReady() {\r\n\r\n            //Ëá™ÂÆö‰πâËøîÂõûÊåâÈíÆ Âõ†‰∏∫ÂéüÁîüÁöÑËøîÂõûÊåâÈíÆ‰∏çÂèØÈòªÊ≠¢ÈªòËÆ§‰∫ã‰ª∂\r\n            // #ifdef H5\r\n            const icon = document.getElementsByClassName('uni-page-head-btn')[0];\r\n            icon.style.display = 'none';\r\n            // #endif\r\n\r\n            uni.setNavigationBarTitle({\r\n                title: this.fromUserInfo.fromUserName ? this.fromUserInfo.fromUserName : 'Á≥ªÁªüÂÆ¢Êúç'\r\n            });\r\n            // this.joinData();\r\n            uni.getSystemInfo({\r\n                success: res => {\r\n                    this.imgHeight = res.windowHeight + 'px';\r\n                }\r\n            });\r\n\r\n            uni.onKeyboardHeightChange(res => {\r\n                if (res.height == 0) {\r\n                    // #ifdef MP-WEIXIN\r\n                    this.mpInputMargin = false;\r\n                    // #endif\r\n                } else {\r\n                    this.showFunBtn = false;\r\n                }\r\n            });\r\n\r\n        }\r\n    };\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    @import './index.scss'\r\n</style>","import mod from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"; export default mod; export * from \"-!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!E:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./chat.vue?vue&type=style&index=0&id=bf16e7f4&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1742194020852\n      var cssReload = require(\"E:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}